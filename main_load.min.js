var currency,currency_format;$(document).ready(function(){function e(e){var t=RegExp("[\\?&]"+(e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"))+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}currency="<?php echo $currency; ?>",currency_format="<?php echo $currency_format; ?>",$("#add_to_cart").click(function(e){e.preventDefault(),$("#no_items_cart").hide();var t=$("#id_produto").val(),a=$("#qnt").val();$.ajax({type:"POST",url:"adicionar_carrinho.php",data:{id_produto:t,qnt:a},success:function(e){"success"===e.status?($(".cart-container").addClass("active"),function e(t){var a=$(".cart-panel"),i=!1;if(a.find(".product").each(function(){var e=$(this),a=e.find("a").attr("href").split("id=")[1].split("&")[0],c=e.find("a").attr("href").split("qnt=")[1];if(a==t.id&&c==t.quantity){i=!0;var r=e.find(".price"),o=r.text().match(RegExp("^(\\d+) X (\\d+\\.\\d+) = (\\d+\\.\\d+) "+currency+"$")),n=o&&o[1]?parseInt(o[1]):0,l=o&&o[2]?parseFloat(o[2]):0,s=(n+=1)*l;return r.text(`${n} X ${l.toFixed(2)} = ${s.toFixed(2)} ${currency}`),!1}}),!i){var c=`
                    <div class="product" style="display: block;">
                    <a href="product.php?id=${t.id}&qnt=${t.quantity}">
                    <img src="${t.image}" alt="${t.name}" style="vertical-align: super; display: inline-block; width: 29%;">
                    <div class="info" style="display: inline-block; width: 64%; vertical-align: top;">
                    <p style="margin: 0; font-weight: bold;">${t.name}</p>
                    <p class="price" style="margin: 0; font-weight: 300; font-size: 15px;">1 X ${t.price.toFixed(2)} = ${t.price.toFixed(2)} ${currency}</p>
                    </div>
                    </a>
                    <span class="remove-btn delete-btn btn btn-danger" data-key="${t.key}" data-itemid="${t.id}" style="background-image: none; color: #fff; background-color: #dc3545; border-color: #dc3545; width: 100%; padding: 4%;"><i class="fa-solid fa-trash" style="font-weight: bold; position: initial;"></i> <?php echo translate("cart_remove_btn"); ?></span>
                    </div>
                    `;a.append(c)}var r=$("#total_carrinho"),o=parseFloat(r.text().replace("Total: ","").replace(" "+currency,""));o+=t.price,r.text("Total: "+o.toFixed(2)+" "+currency)}({id:t,key:e.product.key,name:e.product.name,image:e.product.image,price:parseFloat(e.product.price),quantity:a})):alert("Failed to add product to cart. Please try again.")},error:function(){alert("An error occurred. Please try again.")}})}),$(document).on("click",".delete-btn",function(){console.log("Clicked");var e=$(this).data("key"),t=$(this).data("itemid"),a=$(this).closest(".product");$.ajax({type:"POST",url:"delete_item.php",data:{key:e,item_id:t},success:function(e){if(console.log("AJAX Success:",e),"decremented"===e.status){var t,i,c=a.find(".price"),r=c.text().match(RegExp("^(\\d+) X (\\d+\\.\\d+) = (\\d+\\.\\d+) "+currency+"$")),o=r&&r[1]?parseInt(r[1]):0;if(o>1){o-=1;var n=r&&r[2]?parseFloat(r[2]):0,l=o*n;c.text(`${o} X ${n.toFixed(2)} = ${l.toFixed(2)} ${currency}`)}}else"removed"===e.status&&a.remove();if(t=$("#total_carrinho"),i=0,$(".cart-panel .product .price").each(function(){var e=$(this).text().match(RegExp("^(\\d+) X (\\d+\\.\\d+) = (\\d+\\.\\d+) "+currency+"$"));i+=e&&e[3]?parseFloat(e[3]):0}),t.text("Total: "+i.toFixed(2)+" "+currency),0==$(".cart-panel .product").length){let s=$("#no_items_cart");s.length?s.show():$(".cart-panel").append("<h1 id='no_items_cart' class='text-nice' style='font-weight: 600; text-align: center;'>No items in the cart</h1>")}},error:function(e,t,a){console.log("AJAX Error:",t,a)},dataType:"json"})});let t={1:{title:"1",imageUrl:"<?php echo $imagem_1_pack; ?>",price:"<?php echo $price_pack_1; ?>",extra_price:"24.95"},5:{title:"5",imageUrl:"<?php echo $imagem_5_pack; ?>",price:"<?php echo $price_pack_5; ?>",extra_price:"59.95"},10:{title:"10",imageUrl:"<?php echo $imagem_10_pack; ?>",price:"<?php echo $price_pack_10; ?>",extra_price:"99.95"},20:{title:"20",imageUrl:"<?php echo $imagem_20_pack; ?>",price:"<?php echo $price_pack_20; ?>",extra_price:"159.95"}},a=new URLSearchParams(window.location.search);a.get("id");let i=a.get("qnt");function c(e){t[e]&&($("#qnt_title").text(t[e].title),"0"==t[e].title?$("#product_extra_price_display").text(""):$("#product_extra_price_display").text(t[e].extra_price+currency),$("#product_price_display").text(currency+t[e].price+" "+currency_format),$("#imagem_produto").attr("src",t[e].imageUrl))}c(i),$(".btn-group-toggle-index .btn").each(function(){let e=$(this).data("qnt");i=$("#qnt").val(),e==i&&$(this).addClass("active-pack"),$(this).click(function(){$("html, body").animate({scrollTop:$("#product_section").offset().top-80},600);let t=`index.php?id=${$("#id_produto").val()}&qnt=${e}`;history.pushState(null,null,t),c(e),$(".btn-group-toggle-index .btn").removeClass("active-pack"),$(this).addClass("active-pack"),$("#qnt").val(e)})}),$(".platform-icon-new").click(function(){var e;let t=`index.php?id=${$(this).data("id")}&qnt=${$("#qnt").val()||5}`;history.pushState(null,null,t),window.location.reload(),$("html, body").animate({scrollTop:$("#product_section").offset().top-80},600)}),$(".platform-icon-product").click(function(){var e;let t=`product.php?id=${$(this).data("id")}&qnt=${$("#qnt").val()||5}`;history.pushState(null,null,t),window.location.reload()}),$(document).on("click",".btn-edit",function(){let e=$(this).data("id");Swal.fire({title:"Edit Local Details",html:'<input id="swal-input1" class="swal2-input" placeholder="Nome do Local"><h2></h2>Imagem:<input id="swal-input2" type="file" class="swal2-file">',focusConfirm:!1,preConfirm(){let t=document.getElementById("swal-input1").value,a=$("#swal-input2").prop("files")[0],i=new FormData;return i.append("file",a),i.append("id",e),i.append("nome_local",t),new Promise(function(e,t){$.ajax({url:"edit_local.php",dataType:"json",cache:!1,contentType:!1,processData:!1,data:i,type:"post",success:function(a){"success"===a.status?e(a):t(Error(a.message||"Unknown error."))},error:function(e){t(Error("Request failed."))}})})}}).then(t=>{if(t.value&&"success"===t.value.status){let a=document.getElementById("swal-input1").value,i=t.value.image_url;a&&$("#nome_local_"+e).text(a),i&&$("#imagem_local_"+e).attr("src",i),Swal.fire("Edited!","Your local has been edited.","success")}else Swal.fire("Error!",t.value.message,"error")})}),$(document).on("click",".btn-delete",function(){let e=$(this).data("id");Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"}).then(t=>{t.isConfirmed&&$.ajax({url:"delete_local.php",type:"POST",data:{id:e},success:function(t){"success"===t?(Swal.fire("Deleted!","Your local has been deleted.","success"),$("#coluna_"+e).remove()):Swal.fire("Error!","Failed to delete local.","error")},error:function(){Swal.fire("Error!","Request failed. Please try again.","error")}})})}),(void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile"))&&($("#cards_video_col").remove(),$("#cards_video_col2").removeClass("col-md-6"),$("#cards_video_col2").addClass("col-md-12"),$("#stats_video").append(`
                    <div class="video-container" style="position: relative; width: 100%; height: 70vh; overflow: hidden;">
                    <!-- Video tag -->
                    <video class="lazyload-video" preload="none" autoplay loop muted playsinline style="width: 100%; height: 100%; object-fit: cover;">
                    <source data-src="statistics.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                    </video>

                    <!-- Title is commented out, but can be uncommented if needed
                    <div class="section-tittle" style="position: absolute; bottom: 10px; left: 0; right: 0; text-align: center; z-index: 1;">
                    <h2 class="mb-30 font-nice" style="font-weight: 500 !important; color: white; text-align: center;">Enhance your business's image</h2>
                    </div> -->
                    </div>
                    `),$("#stats_video_col2").remove(),$("#stats_video_col").removeClass("col-md-6"),$("#stats_video_col").addClass("col-md-12"),$(".benefits").addClass("text-center")),$("#send_contact_message").click(function(e){e.preventDefault();var t=$("#contact_name").val().trim(),a=$("#contact_email").val().trim(),i=$("#contact_phone").val().trim(),c=$("#contact_message").val().trim();t&&/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(a)&&/^[+]?[\s.-]?(\d[\s.-]?){7,15}$/.test(i)&&c?$.ajax({type:"POST",url:"send_contact_message.php",data:{nome:t,email:a,telemovel:i,mensagem:c},success:function(e){"success"===e.status?Swal.fire({icon:"success",title:"Message Sent",text:"Your message was sent to us. Have a great day!",confirmButtonText:"Okay"}):Swal.fire({icon:"error",title:"Message Failed",text:"There was an error sending your message. Please try again later...",confirmButtonText:"Okay"})}}):Swal.fire({icon:"warning",title:"Invalid Input",text:"Please ensure all fields are filled correctly.",confirmButtonText:"Okay"})})});